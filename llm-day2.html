<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Day 2 &mdash; The Backward Pass &amp; Chain Rule</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Source+Serif+4:ital,wght@0,300;0,400;0,600;1,300;1,400&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --ink:#1a1a2e; --cream:#faf8f4; --cream-dark:#f0ece4;
    --accent:#c0392b; --blue:#2c3e6b; --green:#27654a;
    --gold:#d4a843; --gray:#7f8c8d; --gray-light:#bdc3c7;
    --purple:#5b2c6f; --orange:#d35400;
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{background:var(--cream);color:var(--ink);font-family:'Source Serif 4',Georgia,serif;line-height:1.7;}
  .progress-strip{position:sticky;top:0;z-index:100;background:var(--ink);padding:0.6rem 2rem;display:flex;align-items:center;gap:0.4rem;font-family:'JetBrains Mono',monospace;font-size:0.65rem;color:#888;}
  .p-dot{width:8px;height:8px;border-radius:50%;border:1.5px solid #555;flex-shrink:0;}
  .p-dot.done{background:var(--green);border-color:var(--green);}
  .p-dot.now{background:var(--accent);border-color:var(--accent);box-shadow:0 0 6px rgba(192,57,43,0.5);}
  .p-line{width:24px;height:1.5px;background:#444;flex-shrink:0;}
  .p-line.done{background:var(--green);}
  .p-label{color:#666;margin-left:0.3rem;margin-right:0.5rem;}
  .p-label.done{color:var(--green);}
  .p-label.now{color:var(--accent);font-weight:600;}
  .back-link{display:block;font-family:'JetBrains Mono',monospace;font-size:0.72rem;letter-spacing:.18em;text-transform:uppercase;color:var(--gray);text-decoration:none;padding:1.2rem 2rem 0;max-width:1100px;margin:0 auto;transition:color .2s;}
  .back-link:hover{color:var(--accent);}
  .header{padding:2rem 2rem 2rem;max-width:1100px;margin:0 auto;border-bottom:3px double var(--ink);}
  .header-meta{font-family:'JetBrains Mono',monospace;font-size:0.72rem;letter-spacing:0.15em;text-transform:uppercase;color:var(--gray);margin-bottom:0.5rem;}
  .phase-tag{background:var(--ink);color:white;padding:0.15rem 0.5rem;border-radius:2px;font-size:0.62rem;margin-right:0.4rem;}
  .header h1{font-family:'Playfair Display',serif;font-size:clamp(2rem,5vw,3.1rem);font-weight:700;line-height:1.15;margin-bottom:0.5rem;}
  .header h1 span{color:var(--accent);}
  .header-sub{font-style:italic;font-size:1.05rem;color:var(--blue);max-width:700px;}
  .content{max-width:1100px;margin:0 auto;padding:2rem 2rem 3rem;}
  .memo-quote{background:var(--cream-dark);border-left:4px solid var(--accent);padding:1.5rem 2rem;margin:0 0 3rem;font-style:italic;font-size:1.02rem;color:var(--blue);position:relative;}
  .memo-quote::before{content:'"\27';font-family:'Playfair Display',serif;font-size:4rem;color:var(--accent);position:absolute;top:-0.5rem;left:0.5rem;opacity:0.25;}
  .memo-quote .attr{display:block;margin-top:0.6rem;font-style:normal;font-size:0.8rem;color:var(--gray);font-family:'JetBrains Mono',monospace;}
  .sh{font-family:'Playfair Display',serif;font-size:1.55rem;font-weight:700;margin:3rem 0 1.25rem;padding-bottom:0.5rem;border-bottom:1px solid var(--gray-light);}
  .sh .n{color:var(--accent);font-style:italic;margin-right:0.2rem;}
  .prose{font-size:1rem;max-width:720px;margin-bottom:1.25rem;}
  .prose strong{color:var(--blue);}
  .prose code,code{font-family:'JetBrains Mono',monospace;font-size:0.83rem;background:var(--cream-dark);padding:0.1rem 0.35rem;border-radius:2px;color:var(--accent);}
  .vf{background:white;border:1px solid var(--gray-light);border-radius:2px;padding:2rem 1.5rem 1.5rem;margin:1.5rem 0 2rem;position:relative;overflow:hidden;}
  .vf::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;}
  .vf.red::before{background:linear-gradient(90deg,var(--accent),var(--orange));}
  .vf.green::before{background:linear-gradient(90deg,var(--green),var(--blue));}
  .vf.gold::before{background:linear-gradient(90deg,var(--gold),var(--accent));}
  .vf.purple::before{background:linear-gradient(90deg,var(--purple),var(--blue));}
  .vf-label{font-family:'JetBrains Mono',monospace;font-size:0.68rem;letter-spacing:0.18em;text-transform:uppercase;color:var(--gray);margin-bottom:1rem;}
  svg text{font-family:'Source Serif 4',Georgia,serif;}
  svg .m{font-family:'JetBrains Mono',monospace;}
  .box{border-radius:2px;padding:1.4rem 1.8rem;margin:2rem 0;position:relative;}
  .box::before{position:absolute;top:-0.75rem;left:1rem;font-size:1.2rem;background:var(--cream);padding:0 0.5rem;}
  .box h4{font-family:'Playfair Display',serif;margin-bottom:0.4rem;font-size:1rem;}
  .box p{font-size:0.93rem;color:#555;}
  .box.insight{background:linear-gradient(135deg,#fdf6e8,#fef9f0);border:1px solid var(--gold);}
  .box.insight::before{content:'\1F4A1';}
  .box.insight h4{color:var(--gold);}
  .box.danger{background:linear-gradient(135deg,#fdf0ef,#fef5f4);border:1px solid var(--accent);}
  .box.danger::before{content:'\26A0\FE0F';}
  .box.danger h4{color:var(--accent);}
  .waterfall{display:grid;grid-template-columns:1fr 1fr;gap:0;margin:2rem 0;border:1px solid var(--gray-light);border-radius:2px;overflow:hidden;}
  .waterfall-header{padding:0.8rem 1.2rem;font-family:'JetBrains Mono',monospace;font-size:0.72rem;letter-spacing:0.12em;text-transform:uppercase;text-align:center;font-weight:600;}
  .wh-fwd{background:var(--green);color:white;}
  .wh-bwd{background:var(--accent);color:white;}
  .waterfall-step{padding:0.9rem 1.2rem;border-bottom:1px solid var(--cream-dark);}
  .waterfall-step:last-child{border-bottom:none;}
  .step-n{font-family:'JetBrains Mono',monospace;font-size:0.65rem;color:var(--gray);text-transform:uppercase;letter-spacing:0.1em;margin-bottom:0.25rem;}
  .step-math{font-family:'JetBrains Mono',monospace;font-size:0.85rem;color:var(--ink);}
  .step-note{font-size:0.8rem;color:#777;margin-top:0.2rem;font-style:italic;}
  .thermo-row{display:flex;align-items:center;gap:0.75rem;padding:0.6rem 0;border-bottom:1px dotted var(--gray-light);}
  .thermo-row:last-child{border-bottom:none;}
  .thermo-label{font-family:'JetBrains Mono',monospace;font-size:0.85rem;width:70px;flex-shrink:0;text-align:right;color:var(--blue);font-weight:600;}
  .thermo-bar-wrap{flex:1;height:26px;background:var(--cream-dark);border-radius:3px;position:relative;overflow:hidden;}
  .thermo-bar{height:100%;border-radius:3px;display:flex;align-items:center;justify-content:flex-end;padding-right:8px;font-family:'JetBrains Mono',monospace;font-size:0.72rem;color:white;font-weight:600;}
  .thermo-bar.pos{background:var(--green);}
  .thermo-bar.neg{background:var(--accent);}
  .thermo-bar.neutral{background:var(--blue);}
  .thermo-meaning{font-size:0.78rem;color:#777;width:220px;flex-shrink:0;font-style:italic;}
  .mx{display:grid;grid-template-columns:auto 1fr 1fr;grid-template-rows:auto 1fr 1fr;gap:0;margin:2rem 0;background:white;border:1px solid var(--gray-light);border-radius:2px;overflow:hidden;}
  .mx-corner{background:var(--ink);padding:0.8rem;}
  .mx-ch{background:var(--ink);color:white;padding:0.8rem;font-family:'JetBrains Mono',monospace;font-size:0.7rem;text-transform:uppercase;letter-spacing:0.1em;text-align:center;display:flex;align-items:center;justify-content:center;}
  .mx-rh{background:var(--ink);color:white;padding:0.8rem;font-family:'JetBrains Mono',monospace;font-size:0.7rem;text-transform:uppercase;letter-spacing:0.1em;writing-mode:vertical-lr;text-orientation:mixed;transform:rotate(180deg);display:flex;align-items:center;justify-content:center;}
  .mx-cell{padding:1.2rem;border:1px solid var(--cream-dark);}
  .mx-cell h4{font-family:'Playfair Display',serif;font-size:0.95rem;margin-bottom:0.4rem;}
  .mx-cell p{font-size:0.83rem;color:#555;line-height:1.5;}
  .mx-cell.best{background:#f0faf4;}
  .mx-cell.worst{background:#fdf0ef;}
  .mx-cell .e{font-size:1.4rem;display:block;margin-bottom:0.4rem;}
  .mx-cell code{font-family:'JetBrains Mono',monospace;font-size:0.8rem;background:var(--cream-dark);padding:0.1rem 0.3rem;border-radius:2px;color:var(--accent);}
  .nb-card{display:flex;align-items:center;gap:1.25rem;background:var(--ink);color:white;border-radius:4px;padding:1.5rem 2rem;margin:2rem 0;text-decoration:none;transition:transform 0.15s ease,box-shadow 0.15s ease;}
  .nb-card:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.15);}
  .nb-icon{width:56px;height:56px;background:var(--orange);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.6rem;flex-shrink:0;}
  .nb-text h4{font-family:'Playfair Display',serif;font-size:1.1rem;margin-bottom:0.2rem;color:white;}
  .nb-text p{font-size:0.82rem;color:#aaa;font-family:'JetBrains Mono',monospace;}
  .nb-arrow{margin-left:auto;font-size:1.5rem;color:var(--gold);flex-shrink:0;}
  .cl{list-style:none;margin:1.5rem 0;}
  .cl li{padding:0.55rem 0 0.55rem 2rem;position:relative;font-size:0.93rem;border-bottom:1px dotted var(--gray-light);}
  .cl li::before{content:'\2610';position:absolute;left:0;color:var(--accent);font-size:1.1rem;}
  .cl li strong{font-family:'JetBrains Mono',monospace;font-size:0.8rem;color:var(--blue);}
  .footer{max-width:1100px;margin:0 auto;padding:2rem;border-top:3px double var(--ink);display:flex;justify-content:space-between;align-items:center;font-family:'JetBrains Mono',monospace;font-size:0.68rem;color:var(--gray);text-transform:uppercase;letter-spacing:0.1em;flex-wrap:wrap;gap:0.5rem;}
  .fi{opacity:0;transform:translateY(16px);animation:fu 0.5s ease forwards;}
  @keyframes fu{to{opacity:1;transform:translateY(0);}}
  .fi:nth-child(2){animation-delay:0.08s;}
  .fi:nth-child(3){animation-delay:0.16s;}
  .fi:nth-child(4){animation-delay:0.24s;}
  @media(max-width:700px){.thermo-meaning{display:none;}.waterfall{grid-template-columns:1fr;}}
  @media(max-width:600px){.header{padding:1.5rem 1rem;}.content{padding:1.5rem 1rem;}.footer{flex-direction:column;gap:0.5rem;text-align:center;}}
</style>
</head>
<body>

<div class="progress-strip">
  <span class="p-dot done"></span><span class="p-label done">1</span>
  <span class="p-line done"></span>
  <span class="p-dot now"></span><span class="p-label now">2</span>
  <span class="p-line"></span>
  <span class="p-dot"></span><span class="p-label">3</span>
  <span class="p-line"></span>
  <span class="p-dot"></span><span class="p-label">4</span>
  <span style="color:#555;margin-left:0.5rem;">&middot; &middot; &middot;</span>
  <span class="p-dot" style="margin-left:0.5rem;"></span><span class="p-label">80</span>
</div>

<a href="index.html" class="back-link">&larr; Back to index</a>

<header class="header fi">
  <div class="header-meta">
    <span class="phase-tag">PHASE 1</span>
    Foundations &middot; Day 2 of 80 &middot; Neural Networks &amp; Backprop
  </div>
  <h1>The <span>Backward Pass</span> &mdash; How Blame Flows</h1>
  <p class="header-sub">Implement the chain rule. Compute gradients. Learn how a neural network traces responsibility backwards from output to every input.</p>
</header>

<main class="content">

  <div class="memo-quote fi">
    Risk means more things can happen than will happen. A gradient is the mirror image of this:
    it tells you, of all the ways this output <em>could</em> have been different, exactly how much
    each input is responsible. The backward pass is a system for attributing blame with mathematical precision.
    <span class="attr">&mdash; Day 2 Principle, adapted from the Marks framework</span>
  </div>

  <!-- SECTION I -->
  <h2 class="sh fi"><span class="n">I.</span> The Two Directions &mdash; Data Down, Gradients Up</h2>
  <p class="prose fi">
    Think of the computation graph as a river system. In the <strong>forward pass</strong>, data flows
    downstream &mdash; from inputs to output, accumulating through operations. In the <strong>backward pass</strong>,
    gradients flow upstream &mdash; from the output back to each input, splitting at every junction.
    The question each gradient answers: <em>&ldquo;How much of the final result is my fault?&rdquo;</em>
  </p>

  <div class="fi">
    <div class="vf green">
      <div class="vf-label">Exhibit A &mdash; The Same Expression, Two Perspectives</div>
      <svg viewBox="0 0 860 380" xmlns="http://www.w3.org/2000/svg" style="width:100%;height:auto;">
        <text x="100" y="22" class="m" font-size="10" fill="#27654a" letter-spacing="0.15em">&#9654; FORWARD: COMPUTE VALUES (LEFT &rarr; RIGHT)</text>
        <rect x="30" y="40" width="110" height="55" rx="4" fill="#f5f8f5" stroke="#27654a" stroke-width="1.8"/>
        <text x="85" y="60" text-anchor="middle" font-size="13" fill="#27654a" font-weight="700">a = 2.0</text>
        <text x="85" y="80" text-anchor="middle" class="m" font-size="9" fill="#999">leaf input</text>
        <rect x="30" y="115" width="110" height="55" rx="4" fill="#f5f8f5" stroke="#27654a" stroke-width="1.8"/>
        <text x="85" y="135" text-anchor="middle" font-size="13" fill="#27654a" font-weight="700">b = &minus;3.0</text>
        <text x="85" y="155" text-anchor="middle" class="m" font-size="9" fill="#999">leaf input</text>
        <circle cx="240" cy="97" r="22" fill="#27654a"/>
        <text x="240" y="103" text-anchor="middle" font-size="16" fill="white" font-weight="700">&times;</text>
        <rect x="295" y="70" width="120" height="55" rx="4" fill="#eef5ee" stroke="#27654a" stroke-width="1.8"/>
        <text x="355" y="90" text-anchor="middle" font-size="12" fill="#27654a" font-weight="600">d = &minus;6.0</text>
        <text x="355" y="110" text-anchor="middle" class="m" font-size="9" fill="#999">a &times; b</text>
        <rect x="295" y="145" width="110" height="55" rx="4" fill="#f5f8f5" stroke="#27654a" stroke-width="1.8"/>
        <text x="350" y="165" text-anchor="middle" font-size="13" fill="#27654a" font-weight="700">c = 10.0</text>
        <text x="350" y="185" text-anchor="middle" class="m" font-size="9" fill="#999">leaf input</text>
        <circle cx="510" cy="130" r="22" fill="#27654a"/>
        <text x="510" y="137" text-anchor="middle" font-size="16" fill="white" font-weight="700">+</text>
        <rect x="570" y="102" width="130" height="55" rx="4" fill="#fdf6e8" stroke="#d4a843" stroke-width="2.2"/>
        <text x="635" y="122" text-anchor="middle" font-size="13" fill="#d4a843" font-weight="700">L = 4.0</text>
        <text x="635" y="142" text-anchor="middle" class="m" font-size="9" fill="#999">d + c = output</text>
        <line x1="140" y1="67" x2="218" y2="87" stroke="#27654a" stroke-width="1.3" marker-end="url(#ag)"/>
        <line x1="140" y1="142" x2="218" y2="107" stroke="#27654a" stroke-width="1.3" marker-end="url(#ag)"/>
        <line x1="262" y1="97" x2="295" y2="97" stroke="#27654a" stroke-width="1.3" marker-end="url(#ag)"/>
        <line x1="415" y1="97" x2="488" y2="120" stroke="#27654a" stroke-width="1.3" marker-end="url(#ag)"/>
        <line x1="405" y1="172" x2="488" y2="140" stroke="#27654a" stroke-width="1.3" marker-end="url(#ag)"/>
        <line x1="532" y1="130" x2="570" y2="130" stroke="#d4a843" stroke-width="1.5" marker-end="url(#ago)"/>
        <line x1="30" y1="220" x2="700" y2="220" stroke="#ddd" stroke-width="1" stroke-dasharray="5"/>
        <text x="100" y="248" class="m" font-size="10" fill="#c0392b" letter-spacing="0.15em">&#9664; BACKWARD: COMPUTE GRADIENTS (RIGHT &rarr; LEFT)</text>
        <rect x="570" y="262" width="130" height="48" rx="4" fill="#fdf6e8" stroke="#d4a843" stroke-width="2.2"/>
        <text x="635" y="282" text-anchor="middle" class="m" font-size="10" fill="#d4a843" font-weight="600">L.grad = 1.0</text>
        <text x="635" y="298" text-anchor="middle" class="m" font-size="8" fill="#999">seed: dL/dL = 1</text>
        <circle cx="510" cy="286" r="18" fill="none" stroke="#c0392b" stroke-width="1.8" stroke-dasharray="4"/>
        <text x="510" y="291" text-anchor="middle" font-size="12" fill="#c0392b" font-weight="700">+</text>
        <rect x="310" y="262" width="130" height="48" rx="4" fill="#fef5f4" stroke="#c0392b" stroke-width="1.5"/>
        <text x="375" y="280" text-anchor="middle" class="m" font-size="10" fill="#c0392b">d.grad = 1.0</text>
        <text x="375" y="296" text-anchor="middle" class="m" font-size="10" fill="#c0392b">c.grad = 1.0</text>
        <circle cx="240" cy="286" r="18" fill="none" stroke="#c0392b" stroke-width="1.8" stroke-dasharray="4"/>
        <text x="240" y="291" text-anchor="middle" font-size="12" fill="#c0392b" font-weight="700">&times;</text>
        <rect x="30" y="262" width="140" height="48" rx="4" fill="#fef5f4" stroke="#c0392b" stroke-width="1.5"/>
        <text x="100" y="280" text-anchor="middle" class="m" font-size="10" fill="#c0392b">a.grad = &minus;3.0</text>
        <text x="100" y="296" text-anchor="middle" class="m" font-size="10" fill="#c0392b">b.grad = 2.0</text>
        <line x1="570" y1="286" x2="528" y2="286" stroke="#c0392b" stroke-width="1.8" stroke-dasharray="5 3" marker-end="url(#ar)"/>
        <line x1="492" y1="286" x2="442" y2="286" stroke="#c0392b" stroke-width="1.8" stroke-dasharray="5 3" marker-end="url(#ar)"/>
        <line x1="310" y1="286" x2="258" y2="286" stroke="#c0392b" stroke-width="1.8" stroke-dasharray="5 3" marker-end="url(#ar)"/>
        <line x1="222" y1="286" x2="172" y2="286" stroke="#c0392b" stroke-width="1.8" stroke-dasharray="5 3" marker-end="url(#ar)"/>
        <text x="480" y="340" text-anchor="middle" class="m" font-size="9" fill="#888">+ distributes: both get G</text>
        <text x="220" y="340" text-anchor="middle" class="m" font-size="9" fill="#888">&times; swaps: a gets b.data&times;G, b gets a.data&times;G</text>
        <rect x="30" y="358" width="670" height="22" rx="2" fill="#1a1a2e"/>
        <text x="355" y="374" text-anchor="middle" class="m" font-size="9" fill="#ccc">EACH GRADIENT = "IF I NUDGE THIS INPUT BY &epsilon;, HOW MUCH DOES L CHANGE?"</text>
        <defs>
          <marker id="ag" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto"><polygon points="0 0,7 2.5,0 5" fill="#27654a"/></marker>
          <marker id="ago" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto"><polygon points="0 0,7 2.5,0 5" fill="#d4a843"/></marker>
          <marker id="ar" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto"><polygon points="0 0,7 2.5,0 5" fill="#c0392b"/></marker>
        </defs>
      </svg>
    </div>
  </div>

  <!-- SECTION II -->
  <h2 class="sh fi"><span class="n">II.</span> The Only Two Local Rules You Need</h2>
  <p class="prose fi">
    Every backward pass, no matter how deep the network, decomposes into just two local operations
    applied in sequence. Master these and you understand all of backpropagation.
  </p>

  <div class="fi">
    <div class="vf purple">
      <div class="vf-label">Exhibit B &mdash; The Two Gradient Rules, Contrasted</div>
      <svg viewBox="0 0 860 320" xmlns="http://www.w3.org/2000/svg" style="width:100%;height:auto;">
        <line x1="430" y1="10" x2="430" y2="310" stroke="#ddd" stroke-width="1"/>
        <!-- Addition card -->
        <rect x="20" y="8" width="390" height="300" rx="6" fill="#f7faf7" stroke="#27654a" stroke-width="1"/>
        <text x="215" y="38" text-anchor="middle" font-size="16" fill="#27654a" font-weight="700">The Distributor</text>
        <text x="215" y="56" text-anchor="middle" class="m" font-size="11" fill="#666">c = a + b</text>
        <rect x="270" y="80" width="90" height="35" rx="4" fill="#fdf6e8" stroke="#d4a843" stroke-width="1.5"/>
        <text x="315" y="102" text-anchor="middle" class="m" font-size="11" fill="#d4a843">G flows in</text>
        <line x1="270" y1="97" x2="200" y2="97" stroke="#27654a" stroke-width="2" marker-end="url(#ag2)"/>
        <line x1="180" y1="97" x2="180" y2="140" stroke="#27654a" stroke-width="2"/>
        <line x1="180" y1="140" x2="100" y2="140" stroke="#27654a" stroke-width="2" marker-end="url(#ag2)"/>
        <line x1="180" y1="165" x2="100" y2="165" stroke="#27654a" stroke-width="2" marker-end="url(#ag2)"/>
        <circle cx="180" cy="152" r="15" fill="#27654a"/>
        <text x="180" y="157" text-anchor="middle" font-size="12" fill="white" font-weight="700">+</text>
        <rect x="35" y="126" width="65" height="30" rx="3" fill="#eef5ee" stroke="#27654a" stroke-width="1.2"/>
        <text x="67" y="146" text-anchor="middle" class="m" font-size="10" fill="#27654a">a: G</text>
        <rect x="35" y="152" width="65" height="30" rx="3" fill="#eef5ee" stroke="#27654a" stroke-width="1.2"/>
        <text x="67" y="172" text-anchor="middle" class="m" font-size="10" fill="#27654a">b: G</text>
        <rect x="55" y="210" width="320" height="45" rx="4" fill="white" stroke="#27654a" stroke-width="1.5"/>
        <text x="215" y="228" text-anchor="middle" class="m" font-size="11" fill="#27654a" font-weight="600">&part;(a+b)/&part;a = 1 &rarr; a.grad += 1 &times; G</text>
        <text x="215" y="245" text-anchor="middle" class="m" font-size="11" fill="#27654a" font-weight="600">&part;(a+b)/&part;b = 1 &rarr; b.grad += 1 &times; G</text>
        <text x="215" y="280" text-anchor="middle" font-size="12" fill="#555" font-style="italic">Both inputs receive the full upstream gradient.</text>
        <text x="215" y="296" text-anchor="middle" font-size="12" fill="#555" font-style="italic">Addition is a gradient &ldquo;splitter&rdquo; &mdash; it copies G to both sides.</text>
        <!-- Multiplication card -->
        <rect x="450" y="8" width="390" height="300" rx="6" fill="#faf5fa" stroke="#5b2c6f" stroke-width="1"/>
        <text x="645" y="38" text-anchor="middle" font-size="16" fill="#5b2c6f" font-weight="700">The Swapper</text>
        <text x="645" y="56" text-anchor="middle" class="m" font-size="11" fill="#666">c = a &times; b</text>
        <rect x="700" y="80" width="90" height="35" rx="4" fill="#fdf6e8" stroke="#d4a843" stroke-width="1.5"/>
        <text x="745" y="102" text-anchor="middle" class="m" font-size="11" fill="#d4a843">G flows in</text>
        <line x1="700" y1="97" x2="640" y2="97" stroke="#5b2c6f" stroke-width="2" marker-end="url(#ap)"/>
        <circle cx="615" cy="152" r="15" fill="#5b2c6f"/>
        <text x="615" y="157" text-anchor="middle" font-size="12" fill="white" font-weight="700">&times;</text>
        <line x1="615" y1="137" x2="540" y2="163" stroke="#5b2c6f" stroke-width="2" marker-end="url(#ap)"/>
        <line x1="615" y1="167" x2="540" y2="140" stroke="#d35400" stroke-width="2" marker-end="url(#ao)"/>
        <rect x="470" y="126" width="70" height="30" rx="3" fill="#faf0fa" stroke="#5b2c6f" stroke-width="1.2"/>
        <text x="505" y="146" text-anchor="middle" class="m" font-size="10" fill="#5b2c6f">a: bG</text>
        <rect x="470" y="152" width="70" height="30" rx="3" fill="#faf0fa" stroke="#5b2c6f" stroke-width="1.2"/>
        <text x="505" y="172" text-anchor="middle" class="m" font-size="10" fill="#d35400">b: aG</text>
        <text x="590" y="125" font-size="9" fill="#999" class="m">swap!</text>
        <rect x="485" y="210" width="320" height="45" rx="4" fill="white" stroke="#5b2c6f" stroke-width="1.5"/>
        <text x="645" y="228" text-anchor="middle" class="m" font-size="11" fill="#5b2c6f" font-weight="600">&part;(a&times;b)/&part;a = b &rarr; a.grad += b.data &times; G</text>
        <text x="645" y="245" text-anchor="middle" class="m" font-size="11" fill="#5b2c6f" font-weight="600">&part;(a&times;b)/&part;b = a &rarr; b.grad += a.data &times; G</text>
        <text x="645" y="280" text-anchor="middle" font-size="12" fill="#555" font-style="italic">Each input receives the other&rsquo;s value &times; upstream gradient.</text>
        <text x="645" y="296" text-anchor="middle" font-size="12" fill="#555" font-style="italic">Multiplication crosses the wires &mdash; a gets b&rsquo;s value, b gets a&rsquo;s.</text>
        <defs>
          <marker id="ag2" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto"><polygon points="0 0,7 2.5,0 5" fill="#27654a"/></marker>
          <marker id="ap" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto"><polygon points="0 0,7 2.5,0 5" fill="#5b2c6f"/></marker>
          <marker id="ao" markerWidth="7" markerHeight="5" refX="6" refY="2.5" orient="auto"><polygon points="0 0,7 2.5,0 5" fill="#d35400"/></marker>
        </defs>
      </svg>
    </div>
  </div>

  <div class="box insight fi">
    <h4>Why Only Two Rules?</h4>
    <p>Karpathy&rsquo;s micrograd starts with just <code>+</code> and <code>&times;</code> because every other operation can be built from them. Subtraction is <code>a + (&minus;1 &times; b)</code>. Division and exponentiation come later. If you deeply understand these two gradient rules and the chain rule, you understand the backward pass for <em>any</em> expression.</p>
  </div>

  <!-- SECTION III: WATERFALL -->
  <h2 class="sh fi"><span class="n">III.</span> Step-by-Step Waterfall &mdash; Forward Mirrors Backward</h2>
  <p class="prose fi">
    Howard Marks teaches that risk analysis means tracing <em>cause and effect through a chain</em>.
    The waterfall below shows how the forward and backward passes mirror each other &mdash; one builds
    the expression, the other unwinds it.
  </p>

  <div class="waterfall fi">
    <div>
      <div class="waterfall-header wh-fwd">&#9654; Forward Pass (compute data)</div>
      <div class="waterfall-step">
        <div class="step-n">Step 1</div>
        <div class="step-math">a = 2.0, b = -3.0, c = 10.0</div>
        <div class="step-note">Initialize leaf values</div>
      </div>
      <div class="waterfall-step">
        <div class="step-n">Step 2</div>
        <div class="step-math">d = a &times; b = &minus;6.0</div>
        <div class="step-note">Multiply, store children=(a,b), op=&apos;*&apos;</div>
      </div>
      <div class="waterfall-step">
        <div class="step-n">Step 3</div>
        <div class="step-math">L = d + c = 4.0</div>
        <div class="step-note">Add, store children=(d,c), op=&apos;+&apos;</div>
      </div>
    </div>
    <div>
      <div class="waterfall-header wh-bwd">&#9664; Backward Pass (compute grads)</div>
      <div class="waterfall-step">
        <div class="step-n">Step 1</div>
        <div class="step-math">L.grad = 1.0</div>
        <div class="step-note">Seed: &ldquo;how much does L affect L?&rdquo; &rarr; 1</div>
      </div>
      <div class="waterfall-step">
        <div class="step-n">Step 2</div>
        <div class="step-math">d.grad += 1.0 &nbsp;|&nbsp; c.grad += 1.0</div>
        <div class="step-note">+ distributes upstream grad unchanged</div>
      </div>
      <div class="waterfall-step">
        <div class="step-n">Step 3</div>
        <div class="step-math">a.grad += (&minus;3)&times;1 &nbsp;|&nbsp; b.grad += (2)&times;1</div>
        <div class="step-note">&times; swaps: a gets b&rsquo;s value, b gets a&rsquo;s value</div>
      </div>
    </div>
  </div>

  <!-- SECTION IV: NOTEBOOK CARD -->
  <h2 class="sh fi"><span class="n">IV.</span> The Implementation &mdash; Hands-On Notebook</h2>
  <p class="prose fi">
    All the code for today lives in a clean, runnable Jupyter notebook. It covers:
    the enhanced Value class with <code>_backward</code>, manual gradient propagation step-by-step,
    PyTorch verification, the <code>+=</code> accumulation trap, and a complex multi-branch expression challenge.
  </p>

  <div class="nb-card fi" style="cursor:pointer;">
    <div class="nb-icon">&#128211;</div>
    <div class="nb-text">
      <h4>day2_backward_pass.ipynb</h4>
      <p>6 sections &middot; Value class + _backward &middot; Manual backprop &middot; PyTorch verification &middot; Exercises</p>
    </div>
    <div class="nb-arrow">&rarr;</div>
  </div>

  <!-- SECTION V: GRADIENT THERMOMETER -->
  <h2 class="sh fi"><span class="n">V.</span> The Gradient Thermometer &mdash; Reading the Results</h2>
  <p class="prose fi">
    Marks reads a risk report by asking &ldquo;what does this number <em>mean</em> for my decision?&rdquo;
    Do the same with gradients. Each one has a direction (positive = increase L, negative = decrease L)
    and a magnitude (how strongly this input influences the output).
  </p>

  <div class="fi">
    <div class="vf gold">
      <div class="vf-label">Exhibit C &mdash; Gradient Magnitudes for L = (a &times; b) + c</div>
      <div class="thermo-row">
        <div class="thermo-label">a.grad</div>
        <div class="thermo-bar-wrap"><div class="thermo-bar neg" style="width:60%;">&minus;3.0</div></div>
        <div class="thermo-meaning">Strongest influence, <em>negative</em> &mdash; increase a &rarr; L drops</div>
      </div>
      <div class="thermo-row">
        <div class="thermo-label">b.grad</div>
        <div class="thermo-bar-wrap"><div class="thermo-bar pos" style="width:40%;">+2.0</div></div>
        <div class="thermo-meaning">Moderate influence, positive &mdash; increase b &rarr; L rises</div>
      </div>
      <div class="thermo-row">
        <div class="thermo-label">c.grad</div>
        <div class="thermo-bar-wrap"><div class="thermo-bar neutral" style="width:20%;">+1.0</div></div>
        <div class="thermo-meaning">Weakest influence &mdash; c passes directly through +</div>
      </div>
      <div class="thermo-row">
        <div class="thermo-label">L.grad</div>
        <div class="thermo-bar-wrap"><div class="thermo-bar" style="width:20%;background:var(--gold);">1.0</div></div>
        <div class="thermo-meaning">Always 1.0 &mdash; the output&rsquo;s effect on itself</div>
      </div>
      <div style="margin-top:1.2rem;padding:0.8rem 1rem;background:var(--cream-dark);border-radius:3px;">
        <p style="font-size:0.85rem;color:#555;margin:0;">
          <strong style="color:var(--ink);">Reading this chart:</strong>
          If you were training a neural network and wanted to <em>increase</em> L,
          you&rsquo;d nudge <code>b</code> upward (positive gradient) and <code>a</code> downward (negative gradient).
          The magnitudes tell you how much each nudge matters &mdash; <code>a</code> has 3&times; more leverage than <code>c</code>.
        </p>
      </div>
    </div>
  </div>

  <div class="box danger fi">
    <h4>The += Accumulation Trap</h4>
    <p>When the same variable appears twice (e.g., <code>L = a + a</code>), its gradient is <strong>2.0</strong>, not 1.0. Each usage of <code>a</code> contributes +1 to the gradient, and these <em>accumulate</em>. Using <code>=</code> instead of <code>+=</code> silently overwrites the first contribution &mdash; producing wrong gradients that are extremely hard to debug. The notebook covers this in Part 5.</p>
  </div>

  <!-- SECTION VI: 2x2 MATRIX -->
  <h2 class="sh fi"><span class="n">VI.</span> The Matrix &mdash; What Matters Today</h2>

  <div class="mx fi">
    <div class="mx-corner"></div>
    <div class="mx-ch">Builds Deep Intuition</div>
    <div class="mx-ch">Surface-Level Only</div>
    <div class="mx-rh">Quick to Do</div>
    <div class="mx-cell best">
      <span class="e">&#127919;</span>
      <h4>DO FIRST</h4>
      <p>Open the notebook. Add <code>_backward</code> to <code>__add__</code> and <code>__mul__</code>. Run the manual backward pass. Verify every gradient against PyTorch.</p>
    </div>
    <div class="mx-cell">
      <span class="e">&#9197;&#65039;</span>
      <h4>DO IF TIME</h4>
      <p>Watch 3Blue1Brown&rsquo;s chain rule video. Good visual intuition but you&rsquo;ll get more from coding it yourself first.</p>
    </div>
    <div class="mx-rh">Slow but Worth It</div>
    <div class="mx-cell">
      <span class="e">&#128400;</span>
      <h4>DO CAREFULLY</h4>
      <p>Part 6 of the notebook: <code>L = (a*b + c) * (a + b)</code>. Draw it on paper first, predict gradients, then verify. This is where real understanding forms.</p>
    </div>
    <div class="mx-cell worst">
      <span class="e">&#128683;</span>
      <h4>AVOID TODAY</h4>
      <p>Implementing topological sort or the full <code>.backward()</code> automation. That&rsquo;s Day 3. Today is strictly about understanding local gradient rules.</p>
    </div>
  </div>

  <!-- SECTION VII: CHECKLIST -->
  <h2 class="sh fi"><span class="n">VII.</span> Today&rsquo;s Deliverables</h2>

  <ul class="cl fi">
    <li><strong>_backward for +:</strong> Both inputs get <code>+= out.grad &times; 1.0</code></li>
    <li><strong>_backward for &times;:</strong> Each input gets <code>+= other.data &times; out.grad</code> (the swap rule)</li>
    <li><strong>Manual backward:</strong> Seed <code>L.grad = 1.0</code>, call <code>_backward()</code> right-to-left, get all gradients</li>
    <li><strong>PyTorch verify:</strong> Rebuild expression with <code>requires_grad=True</code> &mdash; all gradients must match exactly</li>
    <li><strong>+= trap:</strong> Test <code>a + a</code> &mdash; confirm <code>a.grad == 2.0</code>, understand why</li>
    <li><strong>Complex test:</strong> Compute gradients for <code>(a*b + c) * (a + b)</code> on paper, then verify in notebook</li>
  </ul>

  <div class="memo-quote fi" style="margin-top:3rem;">
    The backward pass is not a new algorithm &mdash; it&rsquo;s the chain rule you learned in calculus,
    applied systematically across a graph. Its power doesn&rsquo;t come from complexity. It comes from
    <strong>automation across depth</strong>: the same two local rules, applied hundreds of times,
    train networks with billions of parameters. Today you learn the rules. Tomorrow, you automate them.
    <span class="attr">&mdash; Day 2 Closing Principle</span>
  </div>

</main>

<footer class="footer">
  <span>RAG &amp; LLM Engineer &middot; 80-Day Plan</span>
  <span>Day 2 of 80 &middot; Phase 1: Foundations</span>
  <span>&larr; <a href="llm-day1.html" style="color:inherit;">Day 1: Value Class</a> &nbsp;|&nbsp; &rarr; Day 3: Build MLP</span>
</footer>

</body>
</html>
